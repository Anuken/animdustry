/* Generated by Nim Compiler v1.6.4 */
#define NIM_INTBITS 64
#define NIM_EmulateOverflowChecks

#include "nimbase.h"
#include <unistd.h>
#include <sys/syscall.h>
#include <sys/syscall.h>
#include <errno.h>
#undef LANGUAGE_C
#undef MIPSEB
#undef MIPSEL
#undef PPC
#undef R3000
#undef R4000
#undef i386
#undef linux
#undef mips
#undef near
#undef far
#undef powerpc
#undef unix
#define nimfr_(x, y)
#define nimln_(x, y)
typedef struct NimStrPayload NimStrPayload;
typedef struct NimStringV2 NimStringV2;
struct NimStrPayload {
NI cap;
NIM_CHAR data[SEQ_DECL_SIZE];
};
struct NimStringV2 {
NI len;
NimStrPayload* p;
};
static N_INLINE(NI, urandomInternalImpl__stdZsysrand_17)(NU8* dest, NI destLen_0);
N_LIB_PRIVATE N_NIMCALL(void, failedAssertImpl__systemZassertions_53)(NimStringV2 msg);
N_LIB_PRIVATE N_NIMCALL(NI32, osLastError__pureZos_426)(void);
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void);
static const struct {
  NI cap; NIM_CHAR data[29+1];
} TM__sT0fWggTrXhnxQ79bl9a8nHg_2 = { 29 | NIM_STRLIT_FLAG, "sysrand.nim(191, 18) `false` " };
static const NimStringV2 TM__sT0fWggTrXhnxQ79bl9a8nHg_3 = {29, (NimStrPayload*)&TM__sT0fWggTrXhnxQ79bl9a8nHg_2};
extern NIM_BOOL nimInErrorMode__system_3443;
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void) {
	NIM_BOOL* result;
	result = (NIM_BOOL*)0;
	result = (&nimInErrorMode__system_3443);
	return result;
}
static N_INLINE(NI, urandomInternalImpl__stdZsysrand_17)(NU8* dest, NI destLen_0) {
	NI result;
	NI sizeX60gensym0_;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	result = (NI)0;
	sizeX60gensym0_ = destLen_0;
	{
		if (!(sizeX60gensym0_ == ((NI) 0))) goto LA3_;
		goto BeforeRet_;
	}
	LA3_: ;
	{
		while (1) {
			NI readBytesX60gensym0_;
			if (!(result < sizeX60gensym0_)) goto LA6;
			readBytesX60gensym0_ = syscall(SYS_getrandom, ((void*) ((&dest[result]))), ((int) ((NI)(sizeX60gensym0_ - result))), ((unsigned int) 0));
			{
				if (!(readBytesX60gensym0_ == ((NI) 0))) goto LA9_;
				{
					if (!NIM_TRUE) goto LA13_;
					failedAssertImpl__systemZassertions_53(TM__sT0fWggTrXhnxQ79bl9a8nHg_3);
					if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
				}
				LA13_: ;
			}
			goto LA7_;
			LA9_: ;
			{
				if (!(((NI) 0) < readBytesX60gensym0_)) goto LA16_;
				result += readBytesX60gensym0_;
			}
			goto LA7_;
			LA16_: ;
			{
				{
					NI32 T21_;
					T21_ = (NI32)0;
					T21_ = osLastError__pureZos_426();
					if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
					if (!(((NI) (T21_)) == ((NI) (EINTR)) || ((NI) (T21_)) == ((NI) (EAGAIN)))) goto LA22_;
				}
				goto LA19_;
				LA22_: ;
				{
					result = ((NI) -1);
					goto LA5;
				}
				LA19_: ;
			}
			LA7_: ;
		} LA6: ;
	} LA5: ;
	}BeforeRet_: ;
	return result;
}
N_LIB_PRIVATE N_NIMCALL(NIM_BOOL, urandom__stdZsysrand_50)(NU8* dest, NI destLen_0) {
	NIM_BOOL result;
	NI ret;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	result = (NIM_BOOL)0;
	result = NIM_TRUE;
	ret = urandomInternalImpl__stdZsysrand_17(dest, destLen_0);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	{
		if (!(ret < ((NI) 0))) goto LA3_;
		result = NIM_FALSE;
	}
	LA3_: ;
	}BeforeRet_: ;
	return result;
}
