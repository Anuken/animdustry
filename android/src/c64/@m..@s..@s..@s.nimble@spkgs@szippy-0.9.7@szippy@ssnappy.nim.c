/* Generated by Nim Compiler v1.6.4 */
#define NIM_INTBITS 64
#define NIM_EmulateOverflowChecks

#include "nimbase.h"
#include <string.h>
#undef LANGUAGE_C
#undef MIPSEB
#undef MIPSEL
#undef PPC
#undef R3000
#undef R4000
#undef i386
#undef linux
#undef mips
#undef near
#undef far
#undef powerpc
#undef unix
#define nimfr_(x, y)
#define nimln_(x, y)
typedef struct tySequence__uFLLGQVsiasALrzzzvqnZw tySequence__uFLLGQVsiasALrzzzvqnZw;
typedef struct tySequence__uFLLGQVsiasALrzzzvqnZw_Content tySequence__uFLLGQVsiasALrzzzvqnZw_Content;
typedef struct tyObject_BlockMetadata__TLymcdLvh6woWWQYHaKqoQ tyObject_BlockMetadata__TLymcdLvh6woWWQYHaKqoQ;
struct tySequence__uFLLGQVsiasALrzzzvqnZw {
  NI len; tySequence__uFLLGQVsiasALrzzzvqnZw_Content* p;
};
typedef NU16 tyArray__FuLcipDkC4L7M5U89bz9cYKg[286];
typedef NU16 tyArray__w4pf2aeJoenCwuaCVUN3ig[30];
struct tyObject_BlockMetadata__TLymcdLvh6woWWQYHaKqoQ {
tyArray__FuLcipDkC4L7M5U89bz9cYKg litLenFreq;
tyArray__w4pf2aeJoenCwuaCVUN3ig distanceFreq;
NI numLiterals;
};
typedef NU16 tyArray__IDNmvdfvc5WCJIF9bYBo0dQ[16384];
typedef NU8 tyArray__Cxe6prgo05ftSyAqRHalCw[256];


#ifndef tySequence__uFLLGQVsiasALrzzzvqnZw_Content_PP
#define tySequence__uFLLGQVsiasALrzzzvqnZw_Content_PP
struct tySequence__uFLLGQVsiasALrzzzvqnZw_Content { NI cap; NU16 data[SEQ_DECL_SIZE];};
#endif

      static N_INLINE(void, nimZeroMem)(void* p, NI size);
static N_INLINE(void, nimSetMem__systemZmemory_7)(void* a, int v, NI size);
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void);
N_LIB_PRIVATE N_NIMCALL(void, encodeFragment__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZsnappy_7)(tySequence__uFLLGQVsiasALrzzzvqnZw* encoding, tyObject_BlockMetadata__TLymcdLvh6woWWQYHaKqoQ* metadata, NU8* src, NI* ep, NI start, NI bytesToRead, NU16* compressTable);
static N_INLINE(void, zeroMem__system_1706)(void* p, NI size);
static N_INLINE(NU32, read32__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_390)(NU8* src, NI ip);
N_LIB_PRIVATE N_NIMCALL(void, setLen__OOZOOZOOZOnimbleZpkgsZstb95image4550O53Zstb95imageZread_185)(tySequence__uFLLGQVsiasALrzzzvqnZw* s, NI newlen);
static N_INLINE(NI, determineMatchLength__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_446)(NU8* src, NI s1, NI s2, NI limit);
static N_INLINE(NU64, read64__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_394)(NU8* src, NI ip);
static N_INLINE(NI, countTrailingZeroBits__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_455)(NU64 x);
N_CDECL(int, __builtin_ctzll)(unsigned long long x);
N_LIB_PRIVATE N_NIMCALL(NU16, distanceCodeIndex__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_415)(NU16 value);
extern NIM_CONST tyArray__Cxe6prgo05ftSyAqRHalCw baseLengthIndices__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_27;
extern NIM_BOOL nimInErrorMode__system_3443;
static N_INLINE(void, nimSetMem__systemZmemory_7)(void* a, int v, NI size) {
	void* T1_;
	T1_ = (void*)0;
	T1_ = memset(a, v, ((size_t) (size)));
}
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void) {
	NIM_BOOL* result;
	result = (NIM_BOOL*)0;
	result = (&nimInErrorMode__system_3443);
	return result;
}
static N_INLINE(void, nimZeroMem)(void* p, NI size) {
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	nimSetMem__systemZmemory_7(p, ((int) 0), size);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}BeforeRet_: ;
}
static N_INLINE(void, zeroMem__system_1706)(void* p, NI size) {
	nimZeroMem(p, size);
}
static N_INLINE(NU32, read32__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_390)(NU8* src, NI ip) {
	NU32 result;
	result = (NU32)0;
	result = (*((NU32*) ((&src[ip]))));
	return result;
}
static N_INLINE(NU64, read64__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_394)(NU8* src, NI ip) {
	NU64 result;
	result = (NU64)0;
	result = (*((NU64*) ((&src[ip]))));
	return result;
}
static N_INLINE(NI, countTrailingZeroBits__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_455)(NU64 x) {
	NI result;
	int T1_;
	result = (NI)0;
	T1_ = (int)0;
	T1_ = __builtin_ctzll(x);
	result = ((NI) (T1_));
	return result;
}
static N_INLINE(NI, determineMatchLength__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_446)(NU8* src, NI s1, NI s2, NI limit) {
	NI result;
	NI s1_2;
	NI s2_2;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	result = (NI)0;
	s1_2 = s1;
	s2_2 = s2;
	{
		while (1) {
			NU64 x;
			NU64 T3_;
			NU64 T4_;
			if (!(s2_2 <= (NI)(limit - ((NI) 8)))) goto LA2;
			T3_ = (NU64)0;
			T3_ = read64__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_394(src, s2_2);
			if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
			T4_ = (NU64)0;
			T4_ = read64__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_394(src, (NI)(s1_2 + result));
			if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
			x = (NU64)(T3_ ^ T4_);
			{
				NI matchingBits;
				if (!!((x == 0ULL))) goto LA7_;
				matchingBits = countTrailingZeroBits__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_455(x);
				if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
				result += (NI)((NI64)(matchingBits) >> (NU64)(((NI) 3)));
				goto BeforeRet_;
			}
			LA7_: ;
			s2_2 += ((NI) 8);
			result += ((NI) 8);
		} LA2: ;
	}
	{
		while (1) {
			if (!(s2_2 < limit)) goto LA10;
			{
				if (!!((src[s2_2] == src[(NI)(s1_2 + result)]))) goto LA13_;
				goto BeforeRet_;
			}
			LA13_: ;
			s2_2 += ((NI) 1);
			result += ((NI) 1);
		} LA10: ;
	}
	}BeforeRet_: ;
	return result;
}
N_LIB_PRIVATE N_NIMCALL(void, encodeFragment__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZsnappy_7)(tySequence__uFLLGQVsiasALrzzzvqnZw* encoding, tyObject_BlockMetadata__TLymcdLvh6woWWQYHaKqoQ* metadata, NU8* src, NI* ep, NI start, NI bytesToRead, NU16* compressTable) {
	NI ipEnd;
	NI ip;
	NI nextEmit;
	NI tableSize;
	NI shift;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	ipEnd = (NI)(start + bytesToRead);
	ip = start;
	nextEmit = ip;
	tableSize = ((NI) 256);
	shift = ((NI) 24);
	{
		while (1) {
			NIM_BOOL T3_;
			T3_ = (NIM_BOOL)0;
			T3_ = (tableSize < ((NI) 16384));
			if (!(T3_)) goto LA4_;
			T3_ = (tableSize < bytesToRead);
			LA4_: ;
			if (!T3_) goto LA2;
			tableSize = (NI)((NU64)(tableSize) << (NU64)(((NI) 1)));
			shift -= ((NI) 1);
		} LA2: ;
	}
	zeroMem__system_1706(((void*) ((&compressTable[(((NI) 0))- 0]))), ((NI) ((NI)(tableSize * ((NI) 2)))));
	{
		NI ipLimit;
		NU32 nextHash;
		NU32 T9_;
		if (!(((NI) 15) <= bytesToRead)) goto LA7_;
		ipLimit = (NI)((NI)(start + bytesToRead) - ((NI) 15));
		ip += ((NI) 1);
		T9_ = (NU32)0;
		T9_ = read32__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_390(src, ip);
		if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
		nextHash = (NU32)((NU32)((NU32)((NU32)(T9_) * (NU32)(((NU32) 506832829)))) >> (NU64)(shift));
		{
			while (1) {
				NI skipBytes;
				NI nextIp;
				NI candidate;
				NI remainingX60gensym8_;
				NU64 inputBytes;
				NU32 candidateBytes;
				skipBytes = ((NI) 32);
				nextIp = ip;
				candidate = (NI)0;
				{
					while (1) {
						NU32 h;
						NI bytesBetweenHashLookups;
						NU32 T33_;
						ip = nextIp;
						h = nextHash;
						bytesBetweenHashLookups = (NI)((NI64)(skipBytes) >> (NU64)(((NI) 5)));
						skipBytes += ((NI) 1);
						nextIp = (NI)(ip + bytesBetweenHashLookups);
						{
							if (!(ipLimit < nextIp)) goto LA16_;
							{
								NI remainingX60gensym4_;
								if (!(nextEmit < ipEnd)) goto LA20_;
								{
									NI iX60gensym4_;
									NI colontmp_;
									NI i;
									iX60gensym4_ = (NI)0;
									colontmp_ = (NI)0;
									colontmp_ = (NI)(ipEnd - nextEmit);
									i = ((NI) 0);
									{
										while (1) {
											if (!(i < colontmp_)) goto LA24;
											iX60gensym4_ = i;
											(*metadata).litLenFreq[(src[(NI)(nextEmit + iX60gensym4_)])- 0] += ((NI) 1);
											i += ((NI) 1);
										} LA24: ;
									}
								}
								(*metadata).numLiterals += (NI)(ipEnd - nextEmit);
								remainingX60gensym4_ = (NI)(ipEnd - nextEmit);
								{
									while (1) {
										NI addedX60gensym4_;
										if (!(((NI) 0) < remainingX60gensym4_)) goto LA26;
										{
											NI T29_;
											NI T32_;
											T29_ = (*encoding).len;
											if (!(T29_ < (NI)((*ep) + ((NI) 1)))) goto LA30_;
											T32_ = (*encoding).len;
											setLen__OOZOOZOOZOnimbleZpkgsZstb95image4550O53Zstb95imageZread_185((&(*encoding)), ((NI) ((((NI)(T32_ * ((NI) 2)) >= ((NI) 2)) ? (NI)(T32_ * ((NI) 2)) : ((NI) 2)))));
										}
										LA30_: ;
										addedX60gensym4_ = ((remainingX60gensym4_ <= ((NI) 32767)) ? remainingX60gensym4_ : ((NI) 32767));
										(*encoding).p->data[(*ep)] = ((NU16) (addedX60gensym4_));
										(*ep) += ((NI) 1);
										remainingX60gensym4_ -= addedX60gensym4_;
									} LA26: ;
								}
							}
							LA20_: ;
							goto BeforeRet_;
						}
						LA16_: ;
						T33_ = (NU32)0;
						T33_ = read32__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_390(src, nextIp);
						if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
						nextHash = (NU32)((NU32)((NU32)((NU32)(T33_) * (NU32)(((NU32) 506832829)))) >> (NU64)(shift));
						candidate = (NI)(start + ((NI) (compressTable[(h)- 0])));
						compressTable[(h)- 0] = ((NU16) ((NI)(ip - start)));
						{
							NU32 T36_;
							NU32 T37_;
							T36_ = (NU32)0;
							T36_ = read32__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_390(src, ip);
							if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
							T37_ = (NU32)0;
							T37_ = read32__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_390(src, candidate);
							if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
							if (!(T36_ == T37_)) goto LA38_;
							goto LA12;
						}
						LA38_: ;
					}
				} LA12: ;
				{
					NI iX60gensym8_;
					NI colontmp__2;
					NI i_2;
					iX60gensym8_ = (NI)0;
					colontmp__2 = (NI)0;
					colontmp__2 = (NI)(ip - nextEmit);
					i_2 = ((NI) 0);
					{
						while (1) {
							if (!(i_2 < colontmp__2)) goto LA42;
							iX60gensym8_ = i_2;
							(*metadata).litLenFreq[(src[(NI)(nextEmit + iX60gensym8_)])- 0] += ((NI) 1);
							i_2 += ((NI) 1);
						} LA42: ;
					}
				}
				(*metadata).numLiterals += (NI)(ip - nextEmit);
				remainingX60gensym8_ = (NI)(ip - nextEmit);
				{
					while (1) {
						NI addedX60gensym8_;
						if (!(((NI) 0) < remainingX60gensym8_)) goto LA44;
						{
							NI T47_;
							NI T50_;
							T47_ = (*encoding).len;
							if (!(T47_ < (NI)((*ep) + ((NI) 1)))) goto LA48_;
							T50_ = (*encoding).len;
							setLen__OOZOOZOOZOnimbleZpkgsZstb95image4550O53Zstb95imageZread_185((&(*encoding)), ((NI) ((((NI)(T50_ * ((NI) 2)) >= ((NI) 2)) ? (NI)(T50_ * ((NI) 2)) : ((NI) 2)))));
						}
						LA48_: ;
						addedX60gensym8_ = ((remainingX60gensym8_ <= ((NI) 32767)) ? remainingX60gensym8_ : ((NI) 32767));
						(*encoding).p->data[(*ep)] = ((NU16) (addedX60gensym8_));
						(*ep) += ((NI) 1);
						remainingX60gensym8_ -= addedX60gensym8_;
					} LA44: ;
				}
				inputBytes = (NU64)0;
				candidateBytes = (NU32)0;
				{
					while (1) {
						NI limit;
						NI matched;
						NI T53_;
						NI offset;
						NU16 lengthIndexX60gensym11_;
						NU16 distIndexX60gensym11_;
						NI insertTail;
						NU32 prevHash;
						NU32 curHash;
						limit = ((ipEnd <= (NI)(ip + ((NI) 258))) ? ipEnd : (NI)(ip + ((NI) 258)));
						T53_ = (NI)0;
						T53_ = determineMatchLength__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_446(src, (NI)(candidate + ((NI) 4)), (NI)(ip + ((NI) 4)), limit);
						if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
						matched = (NI)(((NI) 4) + T53_);
						offset = (NI)(ip - candidate);
						ip += matched;
						{
							NI T56_;
							NI T59_;
							T56_ = (*encoding).len;
							if (!(T56_ < (NI)((*ep) + ((NI) 3)))) goto LA57_;
							T59_ = (*encoding).len;
							setLen__OOZOOZOOZOnimbleZpkgsZstb95image4550O53Zstb95imageZread_185((&(*encoding)), ((NI) ((((NI)(T59_ * ((NI) 2)) >= (NI)((*ep) + ((NI) 3))) ? (NI)(T59_ * ((NI) 2)) : (NI)((*ep) + ((NI) 3))))));
						}
						LA57_: ;
						lengthIndexX60gensym11_ = ((NU16) (baseLengthIndices__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_27[((NI)(matched - ((NI) 3)))- 0]));
						distIndexX60gensym11_ = distanceCodeIndex__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_415(((NU16) ((NI)(offset - ((NI) 1)))));
						if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
						(*metadata).litLenFreq[((NU16)((NU16)(lengthIndexX60gensym11_) + (NU16)(((NU16) 257))))- 0] += ((NI) 1);
						(*metadata).distanceFreq[(distIndexX60gensym11_)- 0] += ((NI) 1);
						(*encoding).p->data[(NI)((*ep) + ((NI) 0))] = (NU16)((NU16)((NU16)((NU64)(lengthIndexX60gensym11_) << (NU64)(((NI) 8))) | distIndexX60gensym11_) | ((NU16) 32768));
						(*encoding).p->data[(NI)((*ep) + ((NI) 1))] = ((NU16) (offset));
						(*encoding).p->data[(NI)((*ep) + ((NI) 2))] = ((NU16) (matched));
						(*ep) += ((NI) 3);
						insertTail = (NI)(ip - ((NI) 1));
						nextEmit = ip;
						{
							if (!(ipLimit <= ip)) goto LA62_;
							{
								NI remainingX60gensym15_;
								if (!(nextEmit < ipEnd)) goto LA66_;
								{
									NI iX60gensym15_;
									NI colontmp__3;
									NI i_3;
									iX60gensym15_ = (NI)0;
									colontmp__3 = (NI)0;
									colontmp__3 = (NI)(ipEnd - nextEmit);
									i_3 = ((NI) 0);
									{
										while (1) {
											if (!(i_3 < colontmp__3)) goto LA70;
											iX60gensym15_ = i_3;
											(*metadata).litLenFreq[(src[(NI)(nextEmit + iX60gensym15_)])- 0] += ((NI) 1);
											i_3 += ((NI) 1);
										} LA70: ;
									}
								}
								(*metadata).numLiterals += (NI)(ipEnd - nextEmit);
								remainingX60gensym15_ = (NI)(ipEnd - nextEmit);
								{
									while (1) {
										NI addedX60gensym15_;
										if (!(((NI) 0) < remainingX60gensym15_)) goto LA72;
										{
											NI T75_;
											NI T78_;
											T75_ = (*encoding).len;
											if (!(T75_ < (NI)((*ep) + ((NI) 1)))) goto LA76_;
											T78_ = (*encoding).len;
											setLen__OOZOOZOOZOnimbleZpkgsZstb95image4550O53Zstb95imageZread_185((&(*encoding)), ((NI) ((((NI)(T78_ * ((NI) 2)) >= ((NI) 2)) ? (NI)(T78_ * ((NI) 2)) : ((NI) 2)))));
										}
										LA76_: ;
										addedX60gensym15_ = ((remainingX60gensym15_ <= ((NI) 32767)) ? remainingX60gensym15_ : ((NI) 32767));
										(*encoding).p->data[(*ep)] = ((NU16) (addedX60gensym15_));
										(*ep) += ((NI) 1);
										remainingX60gensym15_ -= addedX60gensym15_;
									} LA72: ;
								}
							}
							LA66_: ;
							goto BeforeRet_;
						}
						LA62_: ;
						inputBytes = read64__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_394(src, insertTail);
						if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
						prevHash = (NU32)((NU32)((NU32)((NU32)(((NU32) ((NU64)((NU64)((NU64)(inputBytes) >> (NU64)(((NI) 0))) & 4294967295ULL)))) * (NU32)(((NU32) 506832829)))) >> (NU64)(shift));
						curHash = (NU32)((NU32)((NU32)((NU32)(((NU32) ((NU64)((NU64)((NU64)(inputBytes) >> (NU64)(((NI) 8))) & 4294967295ULL)))) * (NU32)(((NU32) 506832829)))) >> (NU64)(shift));
						compressTable[(prevHash)- 0] = ((NU16) ((NI)((NI)(ip - start) - ((NI) 1))));
						candidate = (NI)(start + ((NI) (compressTable[(curHash)- 0])));
						candidateBytes = read32__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_390(src, candidate);
						if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
						compressTable[(curHash)- 0] = ((NU16) ((NI)(ip - start)));
						{
							if (!!((((NU32) ((NU64)((NU64)((NU64)(inputBytes) >> (NU64)(((NI) 8))) & 4294967295ULL))) == candidateBytes))) goto LA81_;
							goto LA51;
						}
						LA81_: ;
					}
				} LA51: ;
				nextHash = (NU32)((NU32)((NU32)((NU32)(((NU32) ((NU64)((NU64)((NU64)(inputBytes) >> (NU64)(((NI) 16))) & 4294967295ULL)))) * (NU32)(((NU32) 506832829)))) >> (NU64)(shift));
				ip += ((NI) 1);
			}
		}
	}
	LA7_: ;
	{
		NI remainingX60gensym27_;
		if (!(nextEmit < ipEnd)) goto LA85_;
		{
			NI iX60gensym27_;
			NI colontmp__4;
			NI i_4;
			iX60gensym27_ = (NI)0;
			colontmp__4 = (NI)0;
			colontmp__4 = (NI)(ipEnd - nextEmit);
			i_4 = ((NI) 0);
			{
				while (1) {
					if (!(i_4 < colontmp__4)) goto LA89;
					iX60gensym27_ = i_4;
					(*metadata).litLenFreq[(src[(NI)(nextEmit + iX60gensym27_)])- 0] += ((NI) 1);
					i_4 += ((NI) 1);
				} LA89: ;
			}
		}
		(*metadata).numLiterals += (NI)(ipEnd - nextEmit);
		remainingX60gensym27_ = (NI)(ipEnd - nextEmit);
		{
			while (1) {
				NI addedX60gensym27_;
				if (!(((NI) 0) < remainingX60gensym27_)) goto LA91;
				{
					NI T94_;
					NI T97_;
					T94_ = (*encoding).len;
					if (!(T94_ < (NI)((*ep) + ((NI) 1)))) goto LA95_;
					T97_ = (*encoding).len;
					setLen__OOZOOZOOZOnimbleZpkgsZstb95image4550O53Zstb95imageZread_185((&(*encoding)), ((NI) ((((NI)(T97_ * ((NI) 2)) >= ((NI) 2)) ? (NI)(T97_ * ((NI) 2)) : ((NI) 2)))));
				}
				LA95_: ;
				addedX60gensym27_ = ((remainingX60gensym27_ <= ((NI) 32767)) ? remainingX60gensym27_ : ((NI) 32767));
				(*encoding).p->data[(*ep)] = ((NU16) (addedX60gensym27_));
				(*ep) += ((NI) 1);
				remainingX60gensym27_ -= addedX60gensym27_;
			} LA91: ;
		}
	}
	LA85_: ;
	}BeforeRet_: ;
}
N_LIB_PRIVATE N_NIMCALL(void, encodeSnappy__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZsnappy_327)(tySequence__uFLLGQVsiasALrzzzvqnZw* encoding, NI* ep, tyObject_BlockMetadata__TLymcdLvh6woWWQYHaKqoQ* metadata, NU8* src, NI blockStart, NI blockLen) {
	NI pos;
	tyArray__IDNmvdfvc5WCJIF9bYBo0dQ compressTable;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	(*metadata).litLenFreq[(((NI) 256))- 0] = ((NU16) 1);
	pos = blockStart;
	nimZeroMem((void*)compressTable, sizeof(tyArray__IDNmvdfvc5WCJIF9bYBo0dQ));
	{
		while (1) {
			NI fragmentSize;
			NI bytesToRead;
			if (!(pos < (NI)(blockStart + blockLen))) goto LA2;
			fragmentSize = (NI)((NI)(blockStart + blockLen) - pos);
			bytesToRead = ((fragmentSize <= ((NI) 32768)) ? fragmentSize : ((NI) 32768));
			encodeFragment__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZsnappy_7(encoding, metadata, src, ep, pos, bytesToRead, compressTable);
			if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
			pos += bytesToRead;
		} LA2: ;
	}
	}BeforeRet_: ;
}
