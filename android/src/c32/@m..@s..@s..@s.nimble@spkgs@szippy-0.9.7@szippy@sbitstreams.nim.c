/* Generated by Nim Compiler v1.6.4 */
#define NIM_INTBITS 32
#define NIM_EmulateOverflowChecks

#include "nimbase.h"
#include <string.h>
#undef LANGUAGE_C
#undef MIPSEB
#undef MIPSEL
#undef PPC
#undef R3000
#undef R4000
#undef i386
#undef linux
#undef mips
#undef near
#undef far
#undef powerpc
#undef unix
#define nimfr_(x, y)
#define nimln_(x, y)
typedef struct tyObject_BitStreamReader__L9bhT9bps9bnMmbwnAY0ZCuHg tyObject_BitStreamReader__L9bhT9bps9bnMmbwnAY0ZCuHg;
typedef struct tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ;
typedef struct tyObject_ValueError__yoNlBGx0D2tRizIdhQuENw tyObject_ValueError__yoNlBGx0D2tRizIdhQuENw;
typedef struct tyObject_CatchableError__qrLSDoe2oBoAqNtJ9badtnA tyObject_CatchableError__qrLSDoe2oBoAqNtJ9badtnA;
typedef struct Exception Exception;
typedef struct RootObj RootObj;
typedef struct TNimTypeV2 TNimTypeV2;
typedef struct NimStrPayload NimStrPayload;
typedef struct NimStringV2 NimStringV2;
typedef struct tySequence__uB9b75OUPRENsBAu4AnoePA tySequence__uB9b75OUPRENsBAu4AnoePA;
typedef struct tySequence__uB9b75OUPRENsBAu4AnoePA_Content tySequence__uB9b75OUPRENsBAu4AnoePA_Content;
typedef struct tyObject_BitStreamWriter__1wup4ILzCvMbiIj79cz1B4Q tyObject_BitStreamWriter__1wup4ILzCvMbiIj79cz1B4Q;
typedef struct tyObject_StackTraceEntry__oLyohQ7O2XOvGnflOss8EA tyObject_StackTraceEntry__oLyohQ7O2XOvGnflOss8EA;
struct tyObject_BitStreamReader__L9bhT9bps9bnMmbwnAY0ZCuHg {
NU8* src;
NI len;
NI pos;
NU64 bitBuffer;
NI bitsBuffered;
};
struct TNimTypeV2 {
void* destructor;
NI size;
NI align;
NCSTRING name;
void* traceImpl;
void* typeInfoV1;
NI flags;
};
struct RootObj {
TNimTypeV2* m_type;
};
struct NimStrPayload {
NI cap;
NIM_CHAR data[SEQ_DECL_SIZE];
};
struct NimStringV2 {
NI len;
NimStrPayload* p;
};
struct tySequence__uB9b75OUPRENsBAu4AnoePA {
  NI len; tySequence__uB9b75OUPRENsBAu4AnoePA_Content* p;
};
struct Exception {
  RootObj Sup;
Exception* parent;
NCSTRING name;
NimStringV2 message;
tySequence__uB9b75OUPRENsBAu4AnoePA trace;
Exception* up;
};
struct tyObject_CatchableError__qrLSDoe2oBoAqNtJ9badtnA {
  Exception Sup;
};
struct tyObject_ValueError__yoNlBGx0D2tRizIdhQuENw {
  tyObject_CatchableError__qrLSDoe2oBoAqNtJ9badtnA Sup;
};
struct tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ {
  tyObject_ValueError__yoNlBGx0D2tRizIdhQuENw Sup;
};
struct tyObject_BitStreamWriter__1wup4ILzCvMbiIj79cz1B4Q {
NI pos;
NI bitPos;
};
struct tyObject_StackTraceEntry__oLyohQ7O2XOvGnflOss8EA {
NCSTRING procname;
NI line;
NCSTRING filename;
};


#ifndef tySequence__uB9b75OUPRENsBAu4AnoePA_Content_PP
#define tySequence__uB9b75OUPRENsBAu4AnoePA_Content_PP
struct tySequence__uB9b75OUPRENsBAu4AnoePA_Content { NI cap; tyObject_StackTraceEntry__oLyohQ7O2XOvGnflOss8EA data[SEQ_DECL_SIZE];};
#endif

      N_LIB_PRIVATE N_NIMCALL(void*, nimNewObj)(NI size, NI alignment);
N_LIB_PRIVATE N_NIMCALL(void, raiseExceptionEx)(Exception* e, NCSTRING ename, NCSTRING procname, NCSTRING filename, NI line);
static N_INLINE(void, copyMem__system_1709)(void* dest, void* source, NI size);
static N_INLINE(void, nimCopyMem)(void* dest, void* source, NI size);
N_LIB_PRIVATE N_NIMCALL(void, setLengthStrV2)(NimStringV2* s, NI newLen);
static N_INLINE(void, write64__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_398)(NU8* dst, NI op, NU64 v);
static N_INLINE(NU32, read32__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_390)(NU8* src, NI ip);
static N_INLINE(void, incPos__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZbitstreams_51)(tyObject_BitStreamWriter__1wup4ILzCvMbiIj79cz1B4Q* b, NI bits);
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void);
extern TNimTypeV2 NTIv2__j2RCbV49bRvsx6N3fCdjSIQ_;
static const struct {
  NI cap; NIM_CHAR data[26+1];
} TM__7rCnxYg56U0HCf5pOiFXFw_2 = { 26 | NIM_STRLIT_FLAG, "Must be at a byte boundary" };
static const NimStringV2 TM__7rCnxYg56U0HCf5pOiFXFw_3 = {26, (NimStrPayload*)&TM__7rCnxYg56U0HCf5pOiFXFw_2};
static const struct {
  NI cap; NIM_CHAR data[37+1];
} TM__7rCnxYg56U0HCf5pOiFXFw_4 = { 37 | NIM_STRLIT_FLAG, "Cannot read further, at end of buffer" };
static const NimStringV2 TM__7rCnxYg56U0HCf5pOiFXFw_5 = {37, (NimStrPayload*)&TM__7rCnxYg56U0HCf5pOiFXFw_4};
static const NimStringV2 TM__7rCnxYg56U0HCf5pOiFXFw_6 = {26, (NimStrPayload*)&TM__7rCnxYg56U0HCf5pOiFXFw_2};
extern NIM_BOOL nimInErrorMode__system_3443;
N_LIB_PRIVATE N_NIMCALL(void, skipRemainingBitsInCurrentByte__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZbitstreams_40)(tyObject_BitStreamReader__L9bhT9bps9bnMmbwnAY0ZCuHg* b) {
	NI mod8;
	mod8 = (NI)((*b).bitsBuffered % ((NI) 8));
	{
		if (!!((mod8 == ((NI) 0)))) goto LA3_;
		(*b).bitsBuffered -= mod8;
		(*b).bitBuffer = (NU64)((NU64)((*b).bitBuffer) >> (NU64)(mod8));
	}
	LA3_: ;
}
static N_INLINE(void, nimCopyMem)(void* dest, void* source, NI size) {
	void* T1_;
	T1_ = (void*)0;
	T1_ = memcpy(dest, source, ((size_t) (size)));
}
static N_INLINE(void, copyMem__system_1709)(void* dest, void* source, NI size) {
	nimCopyMem(dest, source, size);
}
N_LIB_PRIVATE N_NIMCALL(void, readBytes__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZbitstreams_33)(tyObject_BitStreamReader__L9bhT9bps9bnMmbwnAY0ZCuHg* b, void* dst, NI len) {
	NI offset;
{	{
		tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ* T5_;
		if (!!(((NI)((*b).bitsBuffered % ((NI) 8)) == ((NI) 0)))) goto LA3_;
		T5_ = NIM_NIL;
		T5_ = (tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ*) nimNewObj(sizeof(tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ), NIM_ALIGNOF(tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ));
		(*T5_).Sup.Sup.Sup.Sup.m_type = (&NTIv2__j2RCbV49bRvsx6N3fCdjSIQ_);
		(*T5_).Sup.Sup.Sup.name = "ZippyError";
		(*T5_).Sup.Sup.Sup.message = TM__7rCnxYg56U0HCf5pOiFXFw_3;
		(*T5_).Sup.Sup.Sup.parent = ((Exception*) NIM_NIL);
		raiseExceptionEx((Exception*)T5_, "ZippyError", "readBytes", "bitstreams.nim", 43);
		goto BeforeRet_;
	}
	LA3_: ;
	offset = (NI)((*b).bitsBuffered / ((NI) 8));
	{
		tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ* T10_;
		if (!((*b).len < (NI)((NI)((*b).pos - offset) + len))) goto LA8_;
		T10_ = NIM_NIL;
		T10_ = (tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ*) nimNewObj(sizeof(tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ), NIM_ALIGNOF(tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ));
		(*T10_).Sup.Sup.Sup.Sup.m_type = (&NTIv2__j2RCbV49bRvsx6N3fCdjSIQ_);
		(*T10_).Sup.Sup.Sup.name = "ZippyError";
		(*T10_).Sup.Sup.Sup.message = TM__7rCnxYg56U0HCf5pOiFXFw_5;
		(*T10_).Sup.Sup.Sup.parent = ((Exception*) NIM_NIL);
		raiseExceptionEx((Exception*)T10_, "ZippyError", "readBytes", "bitstreams.nim", 47);
		goto BeforeRet_;
	}
	LA8_: ;
	copyMem__system_1709(dst, ((void*) ((&(*b).src[(NI)((*b).pos - offset)]))), ((NI) (len)));
	(*b).pos = (NI)((NI)((*b).pos - offset) + len);
	(*b).bitsBuffered = ((NI) 0);
	(*b).bitBuffer = 0ULL;
	}BeforeRet_: ;
}
static N_INLINE(void, write64__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_398)(NU8* dst, NI op, NU64 v) {
	(*((NU64*) ((&dst[op])))) = v;
}
static N_INLINE(NU32, read32__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_390)(NU8* src, NI ip) {
	NU32 result;
	result = (NU32)0;
	result = (*((NU32*) ((&src[ip]))));
	return result;
}
static N_INLINE(void, incPos__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZbitstreams_51)(tyObject_BitStreamWriter__1wup4ILzCvMbiIj79cz1B4Q* b, NI bits) {
	(*b).pos += (NI)((NI32)((NI)(bits + (*b).bitPos)) >> (NU32)(((NI) 3)));
	(*b).bitPos = (NI)((NI)(bits + (*b).bitPos) & ((NI) 7));
}
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void) {
	NIM_BOOL* result;
	result = (NIM_BOOL*)0;
	result = (&nimInErrorMode__system_3443);
	return result;
}
N_LIB_PRIVATE N_NIMCALL(void, addBits__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZbitstreams_62)(tyObject_BitStreamWriter__1wup4ILzCvMbiIj79cz1B4Q* b, NimStringV2* dst, NU32 value, NI bitLen) {
	NU8* dst_2;
	NU64 value_2;
	NU32 T5_;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	{
		if (!((*dst).len < (NI)((*b).pos + ((NI) 8)))) goto LA3_;
		setLengthStrV2((&(*dst)), ((NI) ((((NI)((*dst).len * ((NI) 2)) >= ((NI) 8)) ? (NI)((*dst).len * ((NI) 2)) : ((NI) 8)))));
	}
	LA3_: ;
	dst_2 = ((NU8*) ((&(*dst).p->data[((NI) 0)])));
	value_2 = (NU64)(((NU64) (value)) & (NU64)((NU64)((NU64)((NU64)(1ULL) << (NU64)(bitLen))) - (NU64)(1ULL)));
	T5_ = (NU32)0;
	T5_ = read32__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_390(dst_2, (*b).pos);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	write64__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZinternal_398(dst_2, (*b).pos, (NU64)(((NU64) (T5_)) | (NU64)((NU64)(value_2) << (NU64)((*b).bitPos))));
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	incPos__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZbitstreams_51(b, bitLen);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}BeforeRet_: ;
}
N_LIB_PRIVATE N_NIMCALL(void, skipRemainingBitsInCurrentByte__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZbitstreams_87)(tyObject_BitStreamWriter__1wup4ILzCvMbiIj79cz1B4Q* b) {
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	{
		if (!(((NI) 0) < (*b).bitPos)) goto LA3_;
		incPos__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZbitstreams_51(b, (NI)(((NI) 8) - (*b).bitPos));
		if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}
	LA3_: ;
	}BeforeRet_: ;
}
N_LIB_PRIVATE N_NIMCALL(void, addBytes__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZbitstreams_80)(tyObject_BitStreamWriter__1wup4ILzCvMbiIj79cz1B4Q* b, NimStringV2* dst, NU8* src, NI srcPos, NI len) {
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	{
		tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ* T5_;
		if (!!(((*b).bitPos == ((NI) 0)))) goto LA3_;
		T5_ = NIM_NIL;
		T5_ = (tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ*) nimNewObj(sizeof(tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ), NIM_ALIGNOF(tyObject_ZippyError__j2RCbV49bRvsx6N3fCdjSIQ));
		(*T5_).Sup.Sup.Sup.Sup.m_type = (&NTIv2__j2RCbV49bRvsx6N3fCdjSIQ_);
		(*T5_).Sup.Sup.Sup.name = "ZippyError";
		(*T5_).Sup.Sup.Sup.message = TM__7rCnxYg56U0HCf5pOiFXFw_6;
		(*T5_).Sup.Sup.Sup.parent = ((Exception*) NIM_NIL);
		raiseExceptionEx((Exception*)T5_, "ZippyError", "addBytes", "bitstreams.nim", 90);
		goto BeforeRet_;
	}
	LA3_: ;
	{
		if (!((*dst).len < (NI)((*b).pos + len))) goto LA8_;
		setLengthStrV2((&(*dst)), ((NI) ((NI)((*b).pos + len))));
	}
	LA8_: ;
	copyMem__system_1709(((void*) ((&(*dst).p->data[(*b).pos]))), ((void*) ((&src[srcPos]))), ((NI) (len)));
	incPos__OOZOOZOOZOnimbleZpkgsZzippy4548O57O55ZzippyZbitstreams_51(b, (NI)(len * ((NI) 8)));
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}BeforeRet_: ;
}
